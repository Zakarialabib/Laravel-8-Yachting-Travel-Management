$(window).on("load",function(){var t,e=d3.select("#bracket-tree"),r={top:0,right:0,bottom:0,left:0},n=e.node().getBoundingClientRect().width-r.left-r.right,i=n/2,l=600-r.top-r.bottom-5,a=0,o=500,c=e.append("svg"),s=c.attr("width",n+r.left+r.right).attr("height",l+r.top+r.bottom).append("g").attr("transform","translate("+r.left+","+r.top+")"),u=d3.behavior.zoom().scaleExtent([1,2]).on("zoom",function(){s.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")});c.call(u);var d=d3.layout.tree().size([l,n]),f=(d3.svg.diagonal().projection(function(t){return[t.y,t.x]}),function(t,e){var r=h(t.source),n=h(t.target),i=(n.y-r.y)/2;return t.isRight&&(i=-i),"M"+r.y+","+r.x+"H"+(r.y+i)+"V"+n.x+"H"+n.y}),h=function(t){var e=t.y;return t.isRight||(e=t.y-i,e=i-e),{x:t.x,y:e}},y=function(t,e){e=e||[];var r=0,n=t.children?t.children.length:0;for(e.push(t);r<n;r++)y(t.children[r],e);return e};d3.json("../../../app-assets/data/d3/tree/bracket-tree.json",function(u){(t=u).x0=l/2,t.y0=n/2;var g=d3.layout.tree().size([l,i]).children(function(t){return t.winners}),v=d3.layout.tree().size([l,i]).children(function(t){return t.challengers});g.nodes(t),v.nodes(t);var x=function(t){t.children=function(t){var e=[];if(t.winners)for(var r=0;r<t.winners.length;r++)t.winners[r].isRight=!1,t.winners[r].parent=t,e.push(t.winners[r]);if(t.challengers)for(r=0;r<t.challengers.length;r++)t.challengers[r].isRight=!0,t.challengers[r].parent=t,e.push(t.challengers[r]);return e.length?e:null}(t),t.children&&t.children.forEach(x)};x(t),t.isRight=!1,function t(l){var u=y(l);u.forEach(function(t){t.y=180*t.depth+i});var g=s.selectAll("g.node").data(u,function(t){return t.id||(t.id=++a)});u.forEach(function(t){var e=h(t);t.x0=e.x,t.y0=e.y});var v=g.enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+l.y0+","+l.x0+")"}).on("click",function x(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null);!function t(l){var u=y(l);u.forEach(function(t){t.y=180*t.depth+i});var g=s.selectAll("g.node").data(u,function(t){return t.id||(t.id=++a)});u.forEach(function(t){var e=h(t);t.x0=e.x,t.y0=e.y});var v=g.enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+l.y0+","+l.x0+")"}).on("click",k);v.append("circle").attr("r",1e-6).style("stroke","#F6BB42").style("stroke-width",1.5).style("cursor","pointer").style("fill",function(t){return t._children?"#F6BB42":"#fff"});v.append("text").attr("dy",function(t){return t.isRight?18:-12}).attr("text-anchor","middle").text(function(t){return t.name}).style("font-size",12).style("fill-opacity",1e-6);var x=g.transition().duration(o).attr("transform",function(t){return p=h(t),"translate("+p.y+","+p.x+")"});x.select("circle").attr("r",4.5).style("fill",function(t){return t._children?"#F6BB42":"#fff"});x.select("text").style("fill-opacity",1);var w=g.exit().transition().duration(o).attr("transform",function(t){return p=h(t.parent||l),"translate("+p.y+","+p.x+")"}).remove();w.select("circle").attr("r",1e-6);w.select("text").style("fill-opacity",1e-6);var m=s.selectAll("path.link").data(d.links(u),function(t){return t.target.id});m.enter().insert("path","g").attr("class","link").style("stroke","#F6BB42").style("fill","none").style("stroke-width",1.5).attr("d",function(t){var e={x:l.x0,y:l.y0};return f({source:e,target:e})});m.transition().duration(o).attr("d",f);m.exit().transition().duration(o).attr("d",function(t){var e=h(t.source||l);return t.source.isRight?e.y-=i-(t.target.y-t.source.y):e.y+=i-(t.target.y-t.source.y),f({source:e,target:e})}).remove();function k(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null),t(l)}$(window).on("resize",B);$(".menu-toggle").on("click",B);function B(){n=e.node().getBoundingClientRect().width-r.left-r.right,c.attr("width",n+r.left+r.right),s.attr("width",n+r.left+r.right)}}(l)});v.append("circle").attr("r",1e-6).style("stroke","#F6BB42").style("stroke-width",1.5).style("cursor","pointer").style("fill",function(t){return t._children?"#F6BB42":"#fff"});v.append("text").attr("dy",function(t){return t.isRight?18:-12}).attr("text-anchor","middle").text(function(t){return t.name}).style("font-size",12).style("fill-opacity",1e-6);var w=g.transition().duration(o).attr("transform",function(t){return p=h(t),"translate("+p.y+","+p.x+")"});w.select("circle").attr("r",4.5).style("fill",function(t){return t._children?"#F6BB42":"#fff"});w.select("text").style("fill-opacity",1);var m=g.exit().transition().duration(o).attr("transform",function(t){return p=h(t.parent||l),"translate("+p.y+","+p.x+")"}).remove();m.select("circle").attr("r",1e-6);m.select("text").style("fill-opacity",1e-6);var k=s.selectAll("path.link").data(d.links(u),function(t){return t.target.id});k.enter().insert("path","g").attr("class","link").style("stroke","#F6BB42").style("fill","none").style("stroke-width",1.5).attr("d",function(t){var e={x:l.x0,y:l.y0};return f({source:e,target:e})});k.transition().duration(o).attr("d",f);k.exit().transition().duration(o).attr("d",function(t){var e=h(t.source||l);return t.source.isRight?e.y-=i-(t.target.y-t.source.y):e.y+=i-(t.target.y-t.source.y),f({source:e,target:e})}).remove();function x(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null),t(l)}$(window).on("resize",B);$(".menu-toggle").on("click",B);function B(){n=e.node().getBoundingClientRect().width-r.left-r.right,c.attr("width",n+r.left+r.right),s.attr("width",n+r.left+r.right)}}(t)})});